from graphics import Canvas
import time
import random

CANVAS_WIDTH = 400
CANVAS_HEIGHT = 400
SIZE = 20
INITIAL_VELOCITY = 20
DELAY = 0.1

def main():
    global score
    canvas = Canvas(CANVAS_WIDTH, CANVAS_HEIGHT)
    start_x = 0
    start_y = 0
    score = 0

    player = canvas.create_rectangle(start_x, start_y, start_x+SIZE, start_y+SIZE, 'blue')

    random_x = random.randint(20, CANVAS_WIDTH-SIZE)
    random_y = random.randint(20, CANVAS_HEIGHT-SIZE)
    goal = canvas.create_rectangle(random_x, random_y, random_x+SIZE, random_y+SIZE, 'coral')

    canvas.create_rectangle(0, 375, 70, CANVAS_HEIGHT, color="RED", outline="BLACK")
    text = canvas.create_text(10, 385, text=str(score), font_size=15)

    curr_x = canvas.get_left_x(player)
    curr_y = canvas.get_top_y(player)

    key = 'ArrowRight'  # Initialize with a default direction

    while True:
        try:
            if score == 100:
                canvas.clear()
                canvas.create_text(CANVAS_WIDTH // 2 - 105, CANVAS_HEIGHT // 2, text='YOU WON!!', font_size=30, color="blue")
                time.sleep(DELAY)
                return

            if (curr_x >= 0 and curr_x+SIZE <= CANVAS_WIDTH) and (curr_y >= 0 and curr_y+SIZE <= CANVAS_HEIGHT):
                time.sleep(DELAY)
                temp_key = canvas.get_last_key_press()
                if temp_key:
                    key = temp_key

                if key == 'ArrowRight':
                    curr_x += INITIAL_VELOCITY

                if key == 'ArrowLeft':
                    curr_x -= INITIAL_VELOCITY

                if key == 'ArrowDown':
                    curr_y += INITIAL_VELOCITY

                if key == 'ArrowUp':
                    curr_y -= INITIAL_VELOCITY

                canvas.moveto(player, curr_x, curr_y)  # Update the position of the player

                match = canvas.find_overlapping(random_x, random_y, random_x+SIZE, random_y+SIZE)
                if len(match) > 1:
                    canvas.delete(goal)
                    canvas.delete(text)
                    random_x = random.randint(0, CANVAS_WIDTH-SIZE)
                    random_y = random.randint(0, CANVAS_HEIGHT-SIZE)
                    score += 10
                    text = canvas.create_text(10, 380, text=str(score), font_size=20)
                    goal = canvas.create_rectangle(random_x, random_y, random_x+SIZE, random_y+SIZE, 'coral')

        except KeyboardInterrupt:
            return

if __name__ == '__main__':
    main()
